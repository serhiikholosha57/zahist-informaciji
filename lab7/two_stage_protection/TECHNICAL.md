# Технічний опис системи двоетапного захисту

## Архітектура системи

### Модулі

1. **encryption.py** - Модуль AES шифрування
2. **steganography.py** - Модуль LSB-стеганографії
3. **analytics.py** - Модуль збору та аналізу метрик
4. **main.py** - Головний модуль інтеграції

## Етап 1: AES-256 Шифрування

### Алгоритм
- **Режим**: CBC (Cipher Block Chaining)
- **Довжина ключа**: 256 біт (32 байти)
- **Генерація ключа**: PBKDF2-HMAC-SHA256
- **Ітерації**: 100,000
- **Padding**: PKCS#7

### Процес шифрування
1. Генерація випадкової солі (16 байт)
2. Деривація ключа з пароля через PBKDF2
3. Генерація випадкового IV (16 байт)
4. Додавання padding до даних
5. Шифрування в режимі CBC
6. Формування результату: salt + IV + ciphertext

### Формат зашифрованих даних
```
[0:16]   - Salt (16 байт)
[16:32]  - IV (16 байт)
[32:...]  - Ciphertext (змінна довжина)
```

### Безпека
- Salt запобігає атакам з попередньо обчисленими таблицями
- Високе число ітерацій PBKDF2 захищає від brute-force
- Випадковий IV для кожного шифрування
- CBC забезпечує розповсюдження змін по блокам

## Етап 2: LSB-стеганографія

### Алгоритм
- **Метод**: Заміна молодшого біта (LSB)
- **Контейнер**: PNG зображення
- **Канали**: Всі канали (RGB або RGBA)

### Процес приховування
1. Завантаження зображення-контейнера
2. Конвертація в numpy array
3. Збереження розміру даних (4 байти = 32 біти)
4. Розбиття даних на біти
5. Заміна LSB пікселів на біти даних
6. Збереження стего-зображення

### Формат прихованих даних
```
[0:32 біти]    - Розмір даних (4 байти)
[32:32+N*8]   - Дані (N байт = N*8 біт)
```

### Процес екстракції
1. Завантаження стего-зображення
2. Читання 32 LSB для отримання розміру
3. Читання N*8 наступних LSB
4. Збирання бітів у байти
5. Повернення даних

### Оцінка ємності
```
Ємність = (Ширина × Висота × Канали) / 8 байт
```

Для зображення 400×400×3:
```
Ємність = (400 × 400 × 3) / 8 = 60,000 байт ≈ 58 КБ
```

## Модуль аналітики

### Збираються метрики

#### Етап шифрування
- Розмір оригінального файлу
- Розмір зашифрованих даних
- Накладні витрати (overhead)
- Час виконання

#### Етап стеганографії
- Розмір зашифрованих даних
- Розмір зображення-контейнера
- Розмір стего-зображення
- Час виконання

#### Етап екстракції
- Розмір витягнутих даних
- Час виконання

#### Етап дешифрування
- Розмір розшифрованих даних
- Час виконання

#### Загальна статистика
- Загальний час захисту
- Загальний час відновлення
- Загальний час всіх операцій

### Аналіз та рекомендації

Система автоматично аналізує:
- Ефективність шифрування (час < 1 сек?)
- Використання ємності зображення (< 50% для непомітності)
- Накладні витрати шифрування

## Інтеграція модулів

### Процес захисту
```
Файл → [Шифрування] → Зашифровані дані → [Стеганографія] → Стего-зображення
          ↓                                    ↓
       Метрики 1                           Метрики 2
```

### Процес відновлення
```
Стего-зображення → [Екстракція] → Зашифровані дані → [Дешифрування] → Файл
                        ↓                                  ↓
                   Метрики 3                          Метрики 4
```

### Перевірка цілісності
```python
MD5(Оригінальний файл) == MD5(Відновлений файл)
```

## Вимоги безпеки

### Необхідні компоненти для відновлення
1. **Стего-зображення** - містить зашифровані дані
2. **Пароль** - для дешифрування

Відсутність будь-якого компонента унеможливлює відновлення.

### Атаки та захист

#### Атака: Стеганоаналіз
**Захист**: LSB з низьким використанням ємності (<50%)

#### Атака: Brute-force пароля
**Захист**: PBKDF2 з 100,000 ітерацій

#### Атака: Rainbow tables
**Захист**: Унікальна випадкова сіль для кожного шифрування

#### Атака: Відомий відкритий текст
**Захист**: Випадковий IV для кожного шифрування

## Обмеження

1. **Розмір файлу**: Обмежений ємністю зображення
2. **Формат зображення**: PNG (без втрат)
3. **Видимість змін**: При високому використанні ємності (>50%)

## Продуктивність

### Типові показники (для файлу 343 байти)
- Шифрування: ~0.04 сек
- Стеганографія: ~0.06 сек
- Екстракція: ~0.006 сек
- Дешифрування: ~0.02 сек
- **Загалом**: ~0.13 сек

### Складність
- Шифрування: O(n)
- Стеганографія: O(w×h) де w,h - розміри зображення
- Екстракція: O(n)
- Дешифрування: O(n)

де n - розмір файлу

## Висновок

Система реалізує надійний двоетапний захист:
1. **Конфіденційність** - через AES-256 шифрування
2. **Непомітність** - через LSB-стеганографію
3. **Аналітика** - для оцінки ефективності

Обидва етапи необхідні для доступу до даних, що забезпечує високий рівень захисту.
